// apps/server/prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // or "sqlite" if you are local
}

model Post {
  id          String    @id
  text        String?
  author      String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  lastScraped DateTime  @default(now()) // Added field

  views       Int       @default(0)
  likes       Int       @default(0)
  reposts     Int       @default(0)
  replies     Int       @default(0)

  snapshots   Snapshot[]
}

model Snapshot {
  id        Int      @id @default(autoincrement())
  timestamp DateTime @default(now())
  
  views     Int
  likes     Int
  reposts   Int
  replies   Int
  
  hotness   Int      // Added field
  mood      String   // Added field

  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
}

model SystemLog {
  id        Int      @id @default(autoincrement())
  level     String
  message   String
  metadata  Json?
  timestamp DateTime @default(now())
}